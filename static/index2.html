<!doctype html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <title>Reiner Kniziaâ€™s Decathlon</title>
        <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/pure-min.css" integrity="sha384-Uu6IeWbM+gzNVXJcM9XV3SohHtmWE+3VGi496jvgX1jyvDTXfdK+rfZc8C1Aehk5" crossorigin="anonymous">
        <link href="index2.css" rel="stylesheet">
        <link rel="icon" type="image/png" href="./dices/dice-six-faces-0.png" />
    </head>
    <body>
        <div class="main">
            <audio id="myAudio" loop="loop" style="width:100%">
                <source src="./music/Gaming background music 3.mp3" type="audio/mp3">
            </audio>
            <form class="pure-form pure-form-stacked">
                <label id="info1" for="info"></label>
                <label id="info3" for="info"></label>
                <label id="info2" for="info"></label>
            </form>
            <form class="pure-form pure-g">
                <div class="pure-u-1">
                    <fieldset>
                        <embed id="img0" src="./other/running-man-fat.gif" style="display:block;width:400px;height:400px"/>
                        <!-- <embed id="img0" src="./other/pool-dive-running-bellyflop.gif" style="display:block;width:400px;height:400px"/> -->
                    </fieldset>
                </div>
                <div class="pure-u-1-5">
                    <input type="image" id="form-button1" src="./dices/inverted-dice-1.png" style="display:block;width:100px;height:100px" enabled/>
                    <!-- <embed id="img1" src="./dices/inverted-dice-1.gif" style="display:block;width:100px;height:100px"/> -->
                    <!-- <button type="submit" id="form-button1" class="pure-button pure-button-active" enabled>Freeze</button> -->
                </div>
                <div class="pure-u-1-5">
                    <input type="image" id="form-button2" src="./dices/inverted-dice-1.png" style="display:block;width:100px;height:100px" enabled/>
                    <!-- <embed id="img2" src="./dices/inverted-dice-2.gif" style="display:block;width:100px;height:100px"/> -->
                    <!-- <button type="submit" id="form-button2" class="pure-button pure-button-active" enabled>Freeze</button> -->
                </div>
                <div class="pure-u-1-5">
                    <input type="image" id="form-button3" src="./dices/inverted-dice-1.png" style="display:block;width:100px;height:100px" enabled/>
                    <!-- <embed id="img3" src="./dices/inverted-dice-3.gif" style="display:block;width:100px;height:100px"/> -->
                    <!-- <button type="submit" id="form-button3" class="pure-button pure-button-active" enabled>Freeze</button> -->
                </div>
                <div class="pure-u-1-5">
                    <input type="image" id="form-button4" src="./dices/inverted-dice-1.png" style="display:block;width:100px;height:100px" enabled/>
                    <!-- <embed id="img4" src="./dices/inverted-dice-4.gif" style="display:block;width:100px;height:100px"/> -->
                    <!-- <button type="submit" id="form-button4" class="pure-button pure-button-active" enabled>Freeze</button> -->
                </div>
                <div class="pure-u-1-5">
                    <input type="image" id="form-button5" src="./dices/inverted-dice-1.png" style="display:block;width:100px;height:100px" enabled/>
                    <!-- <embed id="img5" src="./dices/inverted-dice-5.gif" style="display:block;width:100px;height:100px"/> -->
                    <!-- <button type="submit" id="form-button5" class="pure-button pure-button-active" enabled>Freeze</button> -->
                </div>
            </form>
            <form class="pure-form pure-form-stacked">
                <fieldset>
                    <button type="submit" id="form-button6" class="pure-button pure-button-primary" enabled>Throw the dices</button>
                    <button type="submit" id="form-button7" class="pure-button pure-button-primary" enabled>Go to next step</button>
                </fieldset>
            </form>
            <img id="img2" src="./music/volume1.PNG" style="display:block;width:50px;height:50px;position:absolute;bottom:0px;right:0px"/>
            <script src="./back/index2.js"></script>
            <script src="./back/longjump2.js"></script>
            <script>
                var p_name;
                var playMusic = 0;
                var mmode = 0;
                function dicesEnb() {
                    document.querySelector("#form-button1").disabled = dices_enb[0];
                    document.querySelector("#form-button2").disabled = dices_enb[1];
                    document.querySelector("#form-button3").disabled = dices_enb[2];
                    document.querySelector("#form-button4").disabled = dices_enb[3];
                    document.querySelector("#form-button5").disabled = dices_enb[4];
                }
                function dicesEnbTrue() {
                    document.querySelector("#form-button1").disabled = true;
                    document.querySelector("#form-button2").disabled = true;
                    document.querySelector("#form-button3").disabled = true;
                    document.querySelector("#form-button4").disabled = true;
                    document.querySelector("#form-button5").disabled = true;
                }
                function dicesGet() {
                    document.querySelector("#form-button1").src = dices_str[0];
                    document.querySelector("#form-button2").src = dices_str[1];
                    document.querySelector("#form-button3").src = dices_str[2];
                    document.querySelector("#form-button4").src = dices_str[3];
                    document.querySelector("#form-button5").src = dices_str[4];
                }
                function dicesInfo() {
                    document.querySelector("#info1").textContent = infoStr;
                    document.querySelector("#info2").textContent = warnStr;
                }
                function music_pp1() {
                    if(playMusic == 0) {
                        document.querySelector("#img2").src = "./music/volume2.PNG";
                        document.getElementById("myAudio").play();
                        document.getElementById("myAudio").volume = 0.6; // [0, 1]
                        playMusic = 2;
                    } else if(playMusic == 1) {
                        document.querySelector("#img2").src = "./music/volume2.PNG";
                        document.getElementById("myAudio").play();
                        document.getElementById("myAudio").volume = 0.6; // [0, 1]
                        playMusic = 2;
                    } else if(playMusic == 2) {
                        document.querySelector("#img2").src = "./music/volume1.PNG";
                        document.getElementById("myAudio").pause();
                        document.getElementById("myAudio").volume = 0.6; // [0, 1]
                        playMusic = 1;
                    }
                    // console.log(playMusic);
                }
                function music_pp2() {
                    if(playMusic == 0) {
                        document.querySelector("#img2").src = "./music/volume1.PNG";
                        document.getElementById("myAudio").pause();
                        document.getElementById("myAudio").volume = 0.6; // [0, 1]
                    } else if(playMusic == 1) {
                        document.querySelector("#img2").src = "./music/volume1.PNG";
                        document.getElementById("myAudio").pause();
                        document.getElementById("myAudio").volume = 0.6; // [0, 1]
                    } else if(playMusic == 2) {
                        document.querySelector("#img2").src = "./music/volume2.PNG";
                        document.getElementById("myAudio").play();
                        document.getElementById("myAudio").volume = 0.6; // [0, 1]
                    }
                    // console.log(playMusic);
                }
                dicesEnbTrue();
                document.querySelector("#form-button6").disabled = showEnb;
                document.querySelector("#form-button7").disabled = stepEnb;
                dicesInfo();
                window.onload = function() {
                    p_name = popupName();
                }
                document.querySelector("#form-button6").addEventListener("click", (event) => {
                    if(document.querySelector("#form-button6").textContent == "I wanna Retry!!") {
                        window.location.href = "index2.html";
                    }
                    if(mmode == 0) {
                        document.querySelector("#form-button6").textContent = "Cease the dices";
                        document.querySelector("#form-button6").disabled = false;
                        mmode = 1;
                        throwDiceRand();
                        detectFreeze('6');
                        dicesEnbTrue();
                        getDicesVal(1);
                    } else {
                        document.querySelector("#form-button6").textContent = "Throw the dices";
                        document.querySelector("#form-button6").disabled = true;
                        mmode = 0;
                        throwDiceRand();
                        detectFreeze('6');
                        dicesEnb();
                        getDicesVal(0);
                    }
                    dicesGet();
                    event.preventDefault();
                })
                document.querySelector("#form-button7").addEventListener("click", (event) => {
                    if(document.querySelector("#form-button7").textContent == "Return to menu!") {
                        window.location.href = "before_index.html";
                    }
                    document.querySelector("#form-button7").textContent = nextStepSetup();
                    detectFreeze('6');
                    dicesEnb();
                    getDicesVal(0);
                    dicesGet();
                    dicesInfo();
                    document.querySelector("#info3").textContent = getScore();
                    if(showScr) {
                        data = {
                            "pseudo": p_name,
                            "score": score.toString()
                        }
                        fetch("/cookie/?pseudo=" + data.pseudo)
                        fetch("/api/create", {
                            'method': "POST",
                            'headers': {
                                'Content-Type': 'application/json'
                            },
                            'body': JSON.stringify(data)
                        })
                        console.log(JSON.stringify(data, null, ''));
                    }
                    document.querySelector("#img0").src = ImgChange();
                    if(nextStep == 3) {
                        if(score >= 20) {
                            document.querySelector("#myAudio").src = "./music/Dance sound.mp3";
                        } else {
                            document.querySelector("#myAudio").src = "./music/Bonk sound.mp3";
                        }
                    }
                    music_pp2();
                    document.querySelector("#form-button6").disabled = showEnb;
                    document.querySelector("#form-button7").disabled = stepEnb;
                    event.preventDefault();
                })
                document.querySelector("#form-button1").addEventListener("click", (event) => {
                    detectFreeze('1');
                    dicesEnb();
                    getDicesVal(0);
                    dicesGet();
                    dicesInfo();
                    document.querySelector("#form-button6").disabled = showEnb;
                    document.querySelector("#form-button7").disabled = stepEnb;
                    event.preventDefault();
                })
                document.querySelector("#form-button2").addEventListener("click", (event) => {
                    detectFreeze('2');
                    dicesEnb();
                    getDicesVal(0);
                    dicesGet();
                    dicesInfo();
                    document.querySelector("#form-button6").disabled = showEnb;
                    document.querySelector("#form-button7").disabled = stepEnb;
                    event.preventDefault();
                })
                document.querySelector("#form-button3").addEventListener("click", (event) => {
                    detectFreeze('3');
                    dicesEnb();
                    getDicesVal(0);
                    dicesGet();
                    dicesInfo();
                    document.querySelector("#form-button6").disabled = showEnb;
                    document.querySelector("#form-button7").disabled = stepEnb;
                    event.preventDefault();
                })
                document.querySelector("#form-button4").addEventListener("click", (event) => {
                    detectFreeze('4');
                    dicesEnb();
                    getDicesVal(0);
                    dicesGet();
                    dicesInfo();
                    document.querySelector("#form-button6").disabled = showEnb;
                    document.querySelector("#form-button7").disabled = stepEnb;
                    event.preventDefault();
                })
                document.querySelector("#form-button5").addEventListener("click", (event) => {
                    detectFreeze('5');
                    dicesEnb();
                    getDicesVal(0);
                    dicesGet();
                    dicesInfo();
                    document.querySelector("#form-button6").disabled = showEnb;
                    document.querySelector("#form-button7").disabled = stepEnb;
                    event.preventDefault();
                })
                document.querySelector("#img2").addEventListener("click", (event) => {
                    music_pp1();
                })
            </script>
            <script>
                function getCookie(name) {
                    var cookie, c;
                    cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        c = cookies[i].split('=');
                        if (c[0] == name) {
                            return c[1];
                        }
                    }
                    return "";
                }
                p_name = decodeURI(getCookie("pseudo"))
            </script>
    </body>
</html>
